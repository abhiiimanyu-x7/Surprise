<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thank You Ma'am</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@600;700&display=swap" rel="stylesheet">
    <style>
        /* --- STYLING --- */
        :root {
            --bg-1: #ffe2e6; /* Soft Pink */
            --bg-2: #ff9a9e; /* Darker Pink */
            --card-bg: rgba(255, 255, 255, 0.96);
            --primary: #ff4757;
            --text: #2d3436;
        }

        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, var(--bg-1), var(--bg-2));
            font-family: 'Quicksand', sans-serif;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            user-select: none;
        }

        /* Background Canvas (Click-through enabled) */
        #canvas {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        /* --- CARD DESIGN --- */
        .card {
            position: relative;
            z-index: 10;
            background: var(--card-bg);
            width: 85%;
            max-width: 500px;
            padding: 35px;
            border-radius: 25px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            text-align: center;
            border: 4px solid #fff;
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        /* --- ANIMATED CSS ART (No Images) --- */
        .art-stage {
            height: 120px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 25px;
        }

        /* 1. Envelope */
        .envelope {
            width: 80px; height: 50px; background: #ff6b81;
            position: relative; border-radius: 4px;
            animation: bounce 2s infinite;
        }
        .envelope:before {
            content:''; position: absolute; top:0; left:0;
            border-left: 40px solid transparent;
            border-right: 40px solid transparent;
            border-top: 30px solid #ff8fa3;
        }

        /* 2. Pencil */
        .pencil {
            width: 100px; height: 18px; background: #feca57;
            border-radius: 0 4px 4px 0; position: relative;
            animation: write 1s infinite alternate;
        }
        .pencil:before { /* Tip */
            content:''; position: absolute; right: -18px; top: 0;
            border-left: 18px solid #feca57;
            border-top: 9px solid transparent; border-bottom: 9px solid transparent;
        }
        .pencil:after { /* Eraser */
            content:''; position: absolute; left: -15px; top: 0;
            width: 15px; height: 18px; background: #ff6b81;
            border-radius: 3px 0 0 3px;
        }

        /* 3. Heart */
        .heart {
            background: #ff4757; width: 50px; height: 50px;
            position: relative; transform: rotate(-45deg);
            animation: beat 0.8s infinite;
        }
        .heart:before, .heart:after {
            content:''; width: 50px; height: 50px; background: #ff4757;
            border-radius: 50%; position: absolute;
        }
        .heart:before { top: -25px; left: 0; }
        .heart:after { left: 25px; top: 0; }

        /* 4. Star */
        .star {
            font-size: 80px; color: #feca57;
            animation: spin 3s infinite linear;
        }

        /* --- TEXT STYLES --- */
        h1 {
            color: var(--primary);
            font-size: 2rem;
            margin: 0 0 15px 0;
            font-weight: 800;
        }

        .message-box {
            font-size: 1.3rem;
            font-weight: 700; /* BOLD TEXT */
            color: var(--text);
            min-height: 180px;
            text-align: left;
            line-height: 1.5;
            margin-bottom: 20px;
            white-space: pre-wrap;
        }

        /* --- BUTTON --- */
        .btn {
            background: var(--primary);
            color: white;
            font-size: 1.2rem;
            font-weight: 700;
            padding: 15px 45px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(255, 71, 87, 0.4);
            transition: transform 0.2s;
        }
        .btn:hover { transform: scale(1.05); }
        .btn:active { transform: scale(0.95); }

        .hidden { display: none !important; }

        /* Animations */
        @keyframes bounce { 0%, 100% {transform: translateY(0);} 50% {transform: translateY(-10px);} }
        @keyframes write { 0% {transform: rotate(-5deg);} 100% {transform: rotate(5deg);} }
        @keyframes beat { 0% {transform: scale(1) rotate(-45deg);} 50% {transform: scale(1.1) rotate(-45deg);} }
        @keyframes spin { 100% {transform: rotate(360deg);} }

    </style>
</head>
<body>

    <canvas id="canvas"></canvas>

    <div id="intro" class="card">
        <div class="art-stage"><div class="envelope"></div></div>
        <h1>For Shan e Fatima Ma'am</h1>
        <p style="font-weight: 700; color: #888; font-size: 1.2rem;">Tap to Open üíå</p>
        <button class="btn" onclick="start()">Open Letter</button>
    </div>

    <div id="main" class="card hidden">
        <div class="art-stage" id="art"></div>
        <h1 id="title"></h1>
        <div class="message-box" id="text"></div>
        <button class="btn" id="nextBtn" onclick="next()">Continue</button>
    </div>

    <script>
        // --- DATA ---
        const slides = [
            {
                title: "Dear Ma'am,",
                htmlArt: '<div class="envelope"></div>',
                text: "We wanted to take a moment to simply say: Thank You.\n\nIn the rush of classes and assignments, we sometimes forget to appreciate the person guiding us. We see your effort, and we value it.",
                btn: "Read More..."
            },
            {
                title: "Your Hard Work",
                htmlArt: '<div class="pencil"></div>',
                text: "Thank you for not just teaching from the book, but teaching with your heart. Your patience in explaining tough topics and your dedication to our growth inspires us to work harder.",
                btn: "The Impact..."
            },
            {
                title: "The Impact",
                htmlArt: '<div class="heart"></div>',
                text: "Teachers plant seeds that grow forever. The encouragement you give us is the foundation of our future success.\n\nThank you for creating a space where we feel supported.",
                btn: "Final Wish ‚ú®"
            },
            {
                title: "We ‚ù§Ô∏è You!",
                htmlArt: '<div class="star">‚òÖ</div>',
                text: "For the extra hours, the kindness, and the guidance: Thank you, Shan Ma'am!\n\nWe are truly lucky to have you.",
                btn: "Celebrate! üéâ"
            }
        ];

        let index = 0;
        let typingTimer = null; // CRITICAL FIX: To store the timer ID

        // Elements
        const introDiv = document.getElementById('intro');
        const mainDiv = document.getElementById('main');
        const artDiv = document.getElementById('art');
        const titleDiv = document.getElementById('title');
        const textDiv = document.getElementById('text');
        const btn = document.getElementById('nextBtn');

        function start() {
            introDiv.classList.add('hidden');
            mainDiv.classList.remove('hidden');
            showSlide(0);
        }

        function next() {
            index++;
            if(index >= slides.length) {
                celebrate();
            } else {
                showSlide(index);
            }
        }

        function showSlide(i) {
            const slide = slides[i];
            
            // 1. CLEAR previous typing immediately (Fixes the randomness bug)
            if (typingTimer) clearTimeout(typingTimer);
            textDiv.innerHTML = ""; 

            // 2. Set Content
            titleDiv.innerText = slide.title;
            artDiv.innerHTML = slide.htmlArt;
            btn.innerText = slide.btn;

            // 3. Start Typing
            typeWriter(slide.text, 0);
        }

        function typeWriter(txt, i) {
            if (i < txt.length) {
                textDiv.innerHTML += txt.charAt(i);
                i++;
                // Save the timer ID so we can stop it later
                typingTimer = setTimeout(() => typeWriter(txt, i), 20); 
            }
        }

        function celebrate() {
            titleDiv.innerText = "Thank You Ma'am!";
            artDiv.innerHTML = '<div class="heart"></div>';
            
            if (typingTimer) clearTimeout(typingTimer);
            textDiv.innerHTML = "You are the best teacher!<br><br>With love from your student Abhimanyu.";
            textDiv.style.textAlign = "center";
            
            btn.style.display = 'none'; // Hide button
            startConfetti(); // Trigger background effect
        }

        // --- BACKGROUND PARTICLES ---
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let particles = [];

        // Initial Floating Hearts
        for(let i=0; i<40; i++) particles.push(createParticle(false));

        function createParticle(isConfetti) {
            return {
                x: Math.random() * canvas.width,
                y: isConfetti ? canvas.height + 20 : Math.random() * canvas.height,
                size: Math.random() * 15 + 5,
                speedY: isConfetti ? Math.random() * 5 + 2 : Math.random() * 1 + 0.2,
                color: `hsl(${Math.random()*60 + 320}, 100%, 75%)`,
                isConfetti: isConfetti
            };
        }

        function startConfetti() {
            for(let i=0; i<150; i++) particles.push(createParticle(true));
        }

        function animate() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            particles.forEach((p, i) => {
                p.y -= p.speedY;
                if(p.isConfetti) {
                    // Gravity effect
                    p.speedY -= 0.05;
                    if(p.y > canvas.height + 50) particles.splice(i, 1);
                } else {
                    // Loop ambient particles
                    if(p.y < -20) p.y = canvas.height + 20;
                }
                
                ctx.fillStyle = p.color;
                ctx.font = p.size + 'px Arial';
                ctx.fillText('‚ù§Ô∏è', p.x, p.y);
            });
            requestAnimationFrame(animate);
        }
        animate();
        
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

    </script>
</body>
</html>
